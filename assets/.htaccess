AddDefaultCharset utf-8

<IfModule mod_headers.c>

	# Protect against XSS attacks
	Header set X-XSS-Protection "1; mode=block"

	# Protect against page-framing and click-jacking - might disable if iframing is super important
	Header always set X-Frame-Options "SAMEORIGIN"

	# Protect against content-sniffing
	Header always set X-Content-Type-Options "nosniff"

	# Enable HSTS for Preloading
	Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"

	# Content Security Policy is pretty brittle, use with care
	Header set Content-Security-Policy "default-src 'self' www.google.com; base-uri 'self'; form-action 'self'; object-src 'none'; frame-ancestors 'none'; frame-src 'self' www.google.com www.youtube.com onesignal.com; style-src 'self' https: 'unsafe-inline' *.googleapis.com *.google.com onesignal.com; script-src 'self' https: 'unsafe-inline' 'unsafe-eval' *.google-analytics.com *.googleapis.com *.googletagmanager.com *.google.com data:; connect-src 'self' https: *.google-analytics.com *.googleapis.com *.gstatic.com *.googletagmanager.com *.google.com data: stats.g.doubleclick.net cdn.ampproject.org onesignal.com; font-src 'self' https: data:; img-src https: data:;"

	# Enable referrer transmission policies
	Header set Referrer-Policy "strict-origin-when-cross-origin, no-referrer-when-downgrade"

	# Browser feature control
	Header set Feature-Policy "microphone 'none'; geolocation 'self' 'https://viorelmocanu.ro'; vibrate 'none'"
	# Header set Permissions-Policy: geolocation=(self), microphone=(), vibrate=()

	Header set X-UA-Compatible "IE=edge"

	# `mod_headers` cannot match based on the content-type, however,
	# the `X-UA-Compatible` response header should be send only for
	# HTML documents and not for the other resources.
	<FilesMatch "\.(appcache|atom|bbaw|bmp|crx|css|cur|eot|f4[abpv]|flv|geojson|gif|htc|ico|jpe?g|js|json(ld)?|m4[av]|manifest|map|mp4|oex|og[agv]|opus|otf|pdf|png|rdf|rss|safariextz|svgz?|swf|topojson|tt[cf]|txt|vcard|vcf|vtt|webapp|web[mp]|webmanifest|woff2?|xloc|xml|xpi)$">
		Header unset X-UA-Compatible
	</FilesMatch>

	Header unset X-Powered-By

	Header unset Vary

</IfModule>

# ----------------------------------------------------------------------
# Block empty user agents
# ----------------------------------------------------------------------

<IfModule mod_rewrite.c>
	RewriteEngine On 
	RewriteCond %{HTTPS} !on 
	RewriteCond %{REQUEST_URI} !^/[0-9]+\..+\.cpaneldcv$ 
	RewriteCond %{REQUEST_URI} !^/\.well-known/pki-validation/[A-F0-9]{32}\.txt(?:\ Comodo\ DCV)?$ 
	RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

	RewriteCond %{HTTP_USER_AGENT} ^-?$
	RewriteCond %{REQUEST_URI} !^/[0-9]+\..+\.cpaneldcv$
	RewriteCond %{REQUEST_URI} !^/\.well-known/pki-validation/[A-F0-9]{32}\.txt(?:\ Comodo\ DCV)?$
	RewriteRule ^ - [F]

	RewriteCond %{HTTP_HOST} ^viorelmocanu\.ro [NC]
	RewriteCond %{SERVER_PORT} 80
	RewriteRule ^(.*)$ https://viorelmocanu.ro/$1 [R=301,L]
	RewriteCond %{HTTP_HOST} !^www\. [NC]
	RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [R=301,L]
</IfModule>

# 5G:[USER AGENTS]
<IfModule mod_setenvif.c>
	SetEnvIfNoCase User-Agent ^$ keep_out
	SetEnvIfNoCase User-Agent (binlar|casper|cmsworldmap|comodo|diavol|dotbot|feedfinder|flicky|ia_archiver|jakarta|kmccrew|nutch|planetwork|purebot|pycurl|skygrid|sucker|turnit|vikspider|zmeu|curl|perl|java) keep_out
	<limit GET POST PUT>
		Order Allow,Deny
		Allow from all
		Deny from env=keep_out
	</limit>
</IfModule>

# "-Indexes" will have Apache block users from browsing folders without a default document
# Usually you should leave this activated, because you shouldn't allow everybody to surf through
# every folder on your server (which includes rather private places like CMS system folders).
<IfModule mod_autoindex.c>
	Options -Indexes
</IfModule>

<Limit GET POST>
	order deny,allow
	#deny from all
	allow from all
</Limit>

<Limit PUT DELETE>
	order deny,allow
	deny from all
</Limit>

# SGS XMLRPC Disable Service
<Files xmlrpc.php>
	order deny,allow
	deny from all
</Files>
# SGS XMLRPC Disable Service END

DirectoryIndex index.htm index.html index.php

IndexIgnore .htaccess */.??* *~ *# */HEADER* */README* */_vti*
